<div class="admin-diets-container">
  <h2 class="section-title">🥗 Manage Diet Plans</h2>

  <!-- Search Box -->
  <div class="search-box">
    <input type="text" placeholder="Search by email..." [(ngModel)]="searchEmail" (input)="searchByEmail()" />
  </div>

  <div class="admin-diets-content">
    <!-- Left Panel: User List -->
    <div class="user-list">
      <h4>Users</h4>
      <ul>
        <li *ngFor="let user of filteredUsers; let i = index" [class.selected]="i === selectedIndex"
          (click)="selectUser(user, i)">
          {{ user.email }}
        </li>
      </ul>
    </div>

    <div class="diet-details" *ngIf="selectedUser">
      <h4 class="email-label">Editing: {{ selectedUser.email }}</h4>

      <div *ngFor="let week of selectedUser.dietPlan; let wi = index" class="week-card">
        <div class="week-header">
          <h5>📅 Week {{ wi + 1 }}</h5>
          <button class="btn-delete-week" (click)="deleteWeek(wi)">🗑️ Delete Week</button>
        </div>

        <div *ngFor="let day of week.days; let di = index" class="day-card">
          <div class="day-header">
            <h6>🍽️ Day {{ di + 1 }}</h6>
            <button class="btn-delete-day" (click)="deleteDay(wi, di)">❌ Delete Day</button>
          </div>
          <div class="form-group">
            <label>Breakfast</label>
            <input [(ngModel)]="day.breakfast" />
          </div>
          <div class="form-group">
            <label>Lunch</label>
            <input [(ngModel)]="day.lunch" />
          </div>
          <div class="form-group">
            <label>Dinner</label>
            <input [(ngModel)]="day.dinner" />
          </div>
          <div class="form-group">
            <label>Snack (optional)</label>
            <input [(ngModel)]="day.snack" />
          </div>
        </div>

        <button class="btn-add-day" (click)="addDay(wi)">➕ Add Day</button>
      </div>

      <button class="btn-add-week" (click)="addWeek()">➕ Add Week</button><br>
      <button class="btn-save" (click)="saveChanges()">💾 Save Changes</button>
    </div>
  </div>
</div>